<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${pageTitle}">Электрик - профессиональные услуги</title>
    <link rel="stylesheet" href="../static/css/main.css">
    <link rel="stylesheet" href="../static/css/home.css">
    <link rel="stylesheet" href="../static/css/telegram.css">
    <link rel="stylesheet" href="../static/logo/logo.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<header>
    <div class="container">
        <div class="header-content">
            <h1 class="logo-header">
                <img src="../static/logo/logo_white_lamp.svg" alt="Лампочка" class="logo-svg logo-is-hover logo-animation">
                <span class="logo-animation">Профессиональный электрик</span>
            </h1>

            <div class="contact-header">
                <div class="phone">
                    <i class="fas fa-phone"></i>
                    <!-- ИЗМЕНИТЬ НОМЕР ТЕЛЕФОНА ЕСЛИ НЕОБХОДИМО -->
                    <span><a href="tel:+79506219757">Иван</a></span>
                    <!-- Если нужно создать ошибку 500-->
                    <!-- <span th:href="tel: ${contactInfo.phone}" th:text="y54trth"> text </span>-->
                </div>
                <div class="hours">
                    <i class="fas fa-clock"></i>
                    <span th:text="${contactInfo.workingHours}">Ср-Вс: 08:00-17:00</span>
                </div>

                <a href="/reviews" class="admin-btn reviews-btn">
                    <i class="fas fa-comments"></i> Отзывы
                </a>

                <div class="user-menu-container" th:if="${session.user != null}">
                    <div class="user-dropdown">
                        <button class="user-menu-btn">
                            <i class="fas fa-user-circle"></i>
                            <span th:text="${session.user.username}"></span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="user-dropdown-content">
                            <a th:href="@{/profile}">
                                <i class="fas fa-user"></i> Мой профиль
                            </a>
                            <a th:if="${session.user.role == 'ADMIN'}" th:href="@{/admin}">
                                <i class="fas fa-cogs"></i> Админ панель
                            </a>
                            <div class="dropdown-divider"></div>
                            <a th:href="@{/logout}">
                                <i class="fas fa-sign-out-alt"></i> Выйти
                            </a>
                        </div>
                    </div>
                </div>
                <a th:if="${session.user == null}" href="/login" class="admin-btn">
                    <i class="fas fa-sign-in-alt"></i> Войти
                </a>
            </div>
        </div>
    </div>
</header>

<main class="container">
    <div class="main-container">
        <!-- Левая колонка - основной контент -->
        <div class="main-content">
            <section class="hero">
                <h2>Надежные электромонтажные работы любой сложности</h2>
                <p>Работаем быстро, аккуратно и по доступным ценам.</p>
            </section>

            <section class="services">
                <h2><i class="fas fa-bolt"></i> Наши услуги и цены</h2>

                <div class="popular-services" th:if="${not #lists.isEmpty(popularServices)}">
                    <h3>Популярные услуги:</h3>
                    <div class="services-grid">
                        <div class="service-card" th:each="service : ${popularServices}">
                            <h3 th:text="${service.title}">Услуга</h3>
                            <p th:text="${service.description}">Описание услуги</p>
                            <div class="price">
                                <strong th:text="${service.price} + ' ₽'">1000 ₽</strong>
                                <span th:text="${service.priceUnit}">за точку</span>
                            </div>
                            <span class="popular-badge">Популярно</span>
                        </div>
                    </div>
                </div>

                <div class="all-services">
                    <h3>Полный прайс-лист:</h3>
                    <table>
                        <thead>
                        <tr>
                            <th>Услуга</th>
                            <th>Описание</th>
                            <th>Цена</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="service : ${services}">
                            <td th:text="${service.title}">розетка</td>
                            <td th:text="${service.description}">круглая</td>
                            <td>
                                <span th:text="${service.price} + ' ₽'">1000 ₽</span><br>
                                <small th:text="${service.priceUnit}">за штуку</small>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section class="works">
                <h2><i class="fas fa-tools"></i>Крупные работы</h2>
                <div class="works-grid">
                    <div class="work-card" th:each="work : ${works}">
                        <img th:src="${work.imageUrl}" alt="Работа" class="work-image">
                        <div class="work-content">
                            <h3 th:text="${work.title}">Название работы</h3>
                            <div class="work-date" th:text="${work.formattedDate}">15.03.2025</div>
                            <p class="work-description" th:text="${work.description}">Описание работы</p>
                            <div class="work-price" th:text="'от ' + ${#numbers.formatDecimal(work.price, 0, 'DEFAULT', 0, 'DEFAULT') + ' ₽'}">от 25 000 ₽</div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="contact-info">
                <h2><i class="fas fa-address-card"></i> Контактная информация</h2>
                <div class="contact-details">
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span th:text="${contactInfo.address}">г. Нижний Новгород</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-clock"></i>
                        <span th:text="${contactInfo.workingHours}">Пн-Пт: 00:00-00:00</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <span th:text="${contactInfo.phone}">+7 (950) 621-97-57</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span th:text="${contactInfo.email}">electrician@example.com</span>
                    </div>
                    <a href="https://wa.me/79506219757" target="_blank" class="contact-item-whatsapp">
                        <i class="fab fa-whatsapp"></i>
                        <span>WhatsApp</span>
                    </a>

                    <a href="https://t.me/master_electric52" target="_blank" class="contact-item-telegram">
                        <i class="fab fa-telegram"></i>
                        <span>Telegram</span>
                    </a>
                </div>
            </section>
        </div>

        <!-- Правая колонка - Telegram виджет -->
        <aside class="telegram-widget-section">
            <div class="telegram-widget">
                <div class="channel-header">
                    <div class="logo-header">
                        <img src="../static/logo/logo_classic.svg" alt="Лампочка" class="logo-svg logo-animation">
                        <div class="channel-title">
                            <h3 th:text="${channelInfo?.title ?: 'Наш Telegram канал'}">Наш Telegram канал</h3>
                            <div class="channel-description">
                                <span th:text="${channelInfo?.description ?: 'Описание не придумали'}">
                                    Описание
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Статистика -->
                <div class="channel-stats">
                    <div class="stat">
                        <i class="fas fa-users"></i>
                        <div class="stat-info">
                            <span class="stat-value" th:text="${channelInfo?.subscribersCount ?: '100'}">0</span>
                            <span class="stat-label">подписчиков</span>
                        </div>
                    </div>
                    <div class="stat">
                        <i class="fas fa-newspaper"></i>
                        <div class="stat-info">
                            <span class="stat-value" th:text="${postsCount ?: '100'} + '+'">0+</span>
                            <span class="stat-label">постов</span>
                        </div>
                    </div>
                </div>

                <!-- Последний пост -->
                <div class="latest-post">
                    <div class="post-header">
                        <i class="fas fa-paperclip"></i>
                        <h4>Последний пост:</h4>
                    </div>
                    <div class="post-content">
                        <p class="post-text" th:text="${telegramPost?.postText ?: 'Как безопасно заменить розетку?'}">
                            Как безопасно заменить розетку своими руками? Пошаговая инструкция с фото...
                        </p>
                        <div class="post-meta">
                            <span class="post-date">
                                <i class="far fa-calendar"></i>
                                <span th:if="${telegramPost?.createdAt}" th:text="${#temporals.format(telegramPost.createdAt, 'dd.MM.yyyy HH:mm')}">
                                    2 часа назад
                                </span>
                                <span th:unless="${telegramPost?.createdAt}">2 часа назад</span>
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Что в канале -->
                <div class="channel-features">
                    <h4><i class="fas fa-star"></i> Что в канале:</h4>
                    <div class="benefits">
                        <div class="benefit-item">
                            <i class="fas fa-comments"></i>
                            <span>Консультация в чате</span>
                        </div>
                        <div class="benefit-item">
                            <i class="fas fa-video"></i>
                            <span>Видео-обзоры</span>
                        </div>
                        <div class="benefit-item">
                            <i class="fas fa-tools"></i>
                            <span>Выполненные работы</span>
                        </div>
                    </div>
                </div>

                <!-- Кнопка подписаться -->
                <div class="widget-actions">
                    <a th:href="${channelInfo?.inviteLink ?: 'https://t.me/master_electric52'}"
                       class="primary-btn" target="_blank">
                        <i class="fab fa-telegram"></i>
                        <span>Подписаться</span>
                    </a>
                </div>
            </div>
        </aside>
    </div>
</main>

<footer>
    <p>&copy; <span th:text="${#dates.year(#dates.createNow())}">2022</span> Профессиональный электрик. Все права защищены.</p>
</footer>
</body>
</html>